---
title: "Chapter 2-1 Practice"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
library(ggplot2)
library(wooldridge)
ceosal1 <- wooldridge::ceosal1
salary.lm1 <- lm(salary ~ roe, data = ceosal1)
salary.lm2 <- lm(salary ~ 0 + roe, data = ceosal1)
salary.lm3 <- lm(salary ~ 1, data = ceosal1)
gradethis_setup()
tutorial_options(exercise.timelimit = 60)
knitr::opts_chunk$set(echo = FALSE)
```

## CEO Salaries and Return on Equity

Regress CEO salary on: 
1. ROE (with a constant - name this $salary.lm1$); 
2. ROE (without a constant - $salary.lm2$); 
3. Only a constant($salary.lm3$). Plot all three regression lines with a scatterplot of salary on ROE. 
4. Run a `summary()` of all three regressions. 

```{r lmPractice, exercise=TRUE, exercise.reveal_solution = FALSE}

```

```{r lmPractice-solution}
salary.lm1 <- lm(salary ~ roe, data = ceosal1)
salary.lm2 <- lm(salary ~ roe - 1, data = ceosal1)
salary.lm3 <- lm(salary ~ 1, data = ceosal1)
summary(salary.lm1)
summary(salary.lm2)
summary(salary.lm3)
```

```{r lmPractice-check}
grade_this({if (!inherits(.result, c("summary.lm"))) {
    fail("Your class of your answer should be a summary of an lm object.")}
  if (round(.result$coefficients[1],2) != 1281.12) { 
    fail("The coefficient on education should be about 1281.") }
  pass()
})
```

## Plotting the Regression Line

Plot the data for the previous exercise along with all three of the estimated regression lines. 

```{r plotPractice, exercise=TRUE, exercise.reveal_solution = FALSE}

```

```{r plotPractice-solution}
ggplot(ceosal1) + 
  geom_point(aes(roe, salary)) + 
  geom_smooth(aes(roe, salary), method = 'lm') + 
  geom_smooth(aes(roe, salary), method = 'lm', formula = y ~ x - 1, color = 'red') + 
  geom_smooth(aes(roe, salary), method = 'lm', formula = y ~ 1, color = 'darkgreen') + 
  xlab("Return on Equity") + ylab("Salary") + ylim(c(0,5000))
```

```{r plotPractice-check}
grade_this({if (!inherits(.result, c("gg", "ggplot"))) {
    fail("Your class of your answer should be c('gg', 'ggplot').")}
  if (length(.result) != 9) { 
    fail("You should use 'proto' plot functions to add layers to the same plot" ) }
  pass()
})
```

