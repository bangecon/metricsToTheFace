---
title: "Appendix C-1 Practice"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
gradethis_setup()
tutorial_options(exercise.timelimit = 60)
knitr::opts_chunk$set(echo = FALSE)
```

## Simple Regression Simulation

Let $X$ be a random variable that follows a exponential distribution with rate parameter $\lambda = 1$. 
Let $Y$ be a random variable that depends on $X$ according to the known linear structural population model $Y = \beta_0 + \beta_1X + u$, where: 
  
  + $\beta_0 = 2$
  + $\beta_1 = -0.5$
  + $u \sim N(0,1)$

Create a loop that does the following: 

  - Simulate samples of sizes 1-1000 for $X$, $u$, and $Y$.
  - Estimates the equation for Y to obtain $\hat\beta_0$ and $\hat\beta_1$ for each sample size.
  
Show the convergence of the sample estimate of $\beta_1$ towards the known population value of -1 for sample sizes 1 through 1000. 

```{r llnPractice, exercise=TRUE, exercise.eval=TRUE}
set.seed(8675309)


```

```{r llnPractice-hint}

```

```{r llnPractice-solution}
set.seed(8675309)
X <- NULL 
u <- NULL
Y <- NULL
b1 <- NULL
size <- c(1:1000)
for(i in 1:1000) {
  X = rexp(n = size[i], rate = 1)
  u = rnorm(n = size[i], mean = 0, sd = 1)
  Y = 2 - 0.5*X + u
  b1[i] <- lm(Y ~ X)$coefficients[2]
}
plot(size, b1, type = 'l')
abline(h = -0.5, col = 'red')
```

```{r llnPractice-check}
grade_code()
```

## Regression CLT Practice

Using the same population parameters and variables as the previous exercise, create a loop that does the following: 

  - Simulate 1000 *distributions* of $\hat\beta_1$ with 1000 values estimates each from samples $X$, $u$, and $Y$ ranging from 1-1000. 
  - Estimates the equation for Y to obtain $\hat\beta_0$ and $\hat\beta_1$ for each sample size.
  
Plot the convergence of the distribution of $\hat\beta_1$ towards a normal distribution. 

```{r cltPractice, exercise=TRUE, exercise.eval=TRUE}
set.seed(8675309)


```

```{r cltPractice-hint}

```

```{r cltPractice-solution}
set.seed(8675309)
X <- NULL 
u <- NULL
Y <- NULL
b1 <- matrix(NA, nrow = 1000, ncol = 1000)
size <- c(1:1000)
for(i in 1:1000) {
  for(j in 1:1000) {
    X <- rexp(n = size[i], rate = 1) 
    u <- rnorm(n = size[i], mean = 0, sd = 1)
    Y = 2 - 0.5*X + u
    b1[j, i] = lm(Y ~ X)$coefficients[2]
  }
}
plot(density(b1[,2]), xlim = c(-2, 1), ylim = c(0, 4))
lines(density(b1[,10]))
lines(density(b1[,30]))
lines(density(b1[,100]))
```

```{r cltPractice-check}
grade_code()
```
