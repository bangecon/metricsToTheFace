---
output: slidy_presentation
runtime: shiny_prerendered
title: "Appendix B \n\n Fundamentals of Probability" 
description: >
  This tutorial reviews some basic concepts about probability and probability distributions.
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
gradethis::gradethis_setup()
knitr::opts_chunk$set(echo = FALSE)
```

## Probability Distribution of a Discrete Random Variable

Probability mass function, Pr(x), maps all possible values of X into the probabilities that X = x.

+----------------+--------------------------+--------------------------+--------------------------+--------------------------+
| Name           | PMF [$Pr(x=x)$]          | CDF [$P(x<=x)$]          | Quantile [$P^{-1}(p)$]   | Random \#s               |
+================+:========================:+:========================:+:========================:+:========================:+
| Bernoulli      | dbinom(x, 1, $\pi_s$)    | pbinom(x, 1, $\pi_s$)    | qbinom(x, 1, $\pi_s$)    | rbinom(R, 1, $\pi_s$)    |
+----------------+--------------------------+--------------------------+--------------------------+--------------------------+
| Binomial       | dbinom(x, *n*, $\pi_s$)  | pbinom(x, *n*, $\pi_s$)  | qbinom(p, *n*, $\pi_s$)  | rbinom(R, *n*, $\pi_s$)  |
+----------------+--------------------------+--------------------------+--------------------------+--------------------------+
| Hypergeometric | dhyper(x, *S*, *F*, *n*) | phyper(x, *S*, *F*, *n*) | qhyper(p, *S*, *F*, *n*) | rhyper(R, *S*, *F*, *n*) |
+----------------+--------------------------+--------------------------+--------------------------+--------------------------+
| Poisson        | dpois(x, $\lambda$)      | dpois(x, $\lambda$)      | qpois(p, $\lambda$)      | rpois(R, $\lambda$)      |
+----------------+--------------------------+--------------------------+--------------------------+--------------------------+
| Geometric      | dgeom(x, $\pi_s$)        | dgeom(x, $\pi_s$)        | qgeom(p, $\pi_s$)        | rgeom(R, $\pi_s$)        |
+----------------+--------------------------+--------------------------+--------------------------+--------------------------+

: Discrete Probability Distributions in R: x is the value of the variable; p is the cumulative probability; and R is the number of random draws. Other arguments represent parameters of the distribution.

## Probability Density of a Continuous Random Variable

Probability density function, f(x), measures how tightly packed the probability is around x, not the probability at a point ($Pr[X=x]=0$).

+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Name          | PMF [$f(x)$]               | CDF [$P(x<=x)$]            | Quantile [$P^{-1}(p)$]     | Random \#s                 |
+===============+:==========================:+:==========================:+:==========================:+:==========================:+
| Uniform       | dunif(x, min, max)         | punif(x, min, max)         | qunif(p, min, max)         | runif(R, min, max)         |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Logistic      | dlogis(x, $\mu$)           | plogis(x, $\mu$)           | qlogis(p, $\mu$)           | rlogis(R, $\mu$)           |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Exponential   | dexp(x, $\lambda$)         | pexp(x, $\lambda$)         | qexp(p, $\lambda$)         | rexp(R, $\lambda$)         |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Std. Normal   | dnorm(x, 0, 1)             | pnorm(x, 0, 1)             | qnorm(p, 0, 1)             | rnorm(R, 0, 1)             |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Normal        | dnorm(x, $\mu$, $\sigma$)  | pnorm(x, $\mu$, $\sigma$)  | qnorm(p, $\mu$, $\sigma$)  | rnorm(R, $\mu$, $\sigma$)  |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Lognormal     | dlnorm(x, $\mu$, $\sigma$) | plnorm(x, $\mu$, $\sigma$) | qlnorm(p, $\mu$, $\sigma$) | rlnorm(R, $\mu$, $\sigma$) |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| $\chi^2$      | dchisq(x, n)               | pchisq(x, n)               | qchisq(p, n)               | rchisq(R, n)               |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| Student's *t* | dt(x, *df*)                | dt(x, *df*)                | qt (p, *df*)               | rt(R, *df*)                |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+
| *F*           | df(x, *df*~1~, *df*~2~)    | pf(x, *df*~1~, *df*~2~)    | qf(p, *df*~1~, *df*~2~)    | rf(R, *df*~1~, *df*~2~)    |
+---------------+----------------------------+----------------------------+----------------------------+----------------------------+

: Discrete Probability Distributions in R: x is the value of the variable; p is the cumulative probability; and R is the number of random draws. Other arguments represent parameters of the distribution.

## Probability Distribution of a Random Variable

Cumulative probabilities for a discrete R.V.

$$P(X \le x^*)= \sum_{x=-\infty}^{x^*}p(x)$$

Cumulative probabilities for a continuous R.V.

$$P(X \le x^*)= F(x^*) = \int_{-\infty}^{x^*}f(x)dx$$ = The area under f to the left of x.

$$P(X = x^*) = \int_{x^*}^{x^*}f(x)dx = F(x^*) - F(x^*) = 0$$

## Expected Value of a Discrete Random Variable

$$E(X)= \sum_{x=-\infty}^{\infty}xp(x)= \vec{x} \cdot \vec{p}(x)$$

For a random variable, z, defined on a uniform *discrete* distribution, pz, from zero to ten, calculate:

  -   $E(z)$
  -   $E(z)^2$
  -   $E(z^2)$

```{r discreteEz, exercise = TRUE}
# Define z

# Define p(z) 

# Calculate E(z), E(z)^2, and E(z^2) - do not worry about storing them as objects

```

```{r discreteEz-hint}
# The ":" operator indicates a sequence "through" the number before and after it.
z <- c(...:...)
# The "rep" function repeats a value a specified number of times. 
# Careful! How many values exist on the interval [0, 10]?
# To be sure, use length(x) in your formula for p(x).
pz <- rep(1/n, n)
# Use the matrix multiplication operator %*% to calculate the cross-product.
...%*%... # (E(x))
...       # (E(x)^2)
...%*%... # (E(x^2))
```

```{r discreteEz-solution}
# Define x 
z <- c(0:10)
# Define p(x) 
pz <- rep(1/length(z), length(z))
# Calculate E(z), E(z)^2, and E(z^2)
z%*%pz
(z%*%pz)^2
z^2%*%pz
```

```{r discreteEz-check}
grade_code()
```

## Expected Value of a Continuous Random Variable

Expected Value of a continuous R.V.

$$E(X) = \int_{-\infty}^{\infty}xf(x)dx$$

For a random variable, x, defined on a uniform *continuous* distribution between zero and ten:

-   E(x)
-   E(x)\^2
-   E(x\^2)

```{r continuousEx, exercise = TRUE}
# Define f(x), xf(x), and x^2f(x) 

# Calculate E(x), E(x)^2, and E(x^2)

```

```{r continuousEx-hint}
# The "function" function lets you define a mathematical function of a continuous real valued-x. 
f.x <- function(x) {...}
xf.x <- function(x) {...}
x2f.x <- function(x) {...}
# Use the "integrate" function to calculate the appropriate integrals (add up the itty bits).
integrate(xf.x, 0, 10)
integrate(xf.x, 0, 10)^2
integrate(x2f.x, 0, 10)
```

```{r continuousEx-solution}
# Define f(x) 
f.x <- function(x) {(1/10)}
# Calculate E(x), E(X)^2, and E(X^2)
x%*%p(x)
mu.x^2
x^2%*%p(x)
```

```{r continuousEx-check}
grade_code("Notice that $E(X^2) > E(X)^2$. This because x^2 is a convex function, and this property is known as Jensen’s Inequality.")
```

## Expected Value of a Function of a R.V.

Linear functions and expectation

-   You can split addition.
-   Constants "pass through" the expectation
-   If the function, *f*, that you pass to x is *linear*, then $E[g(X)] = g[E(X)]$, i.e. for constants a and b, $$E(a + bX) = a + bE(X)$$

## Law of Iterated Expectations

-   For any function, *f*, $$E[f(X)|X] = f(X)$$
-   For *linear* functions, *g* and *h*, $$E[a(X)Y + b(X) | X] $$ For example, $$E(xY + 2x^2 | x) = xE(Y|x) + 2X^2$$
-   If *X* and *Y* are independent, $$E(Y|X) = E(Y)$$

<html>

<blockquote class="twitter-tweet">

<p lang="und" dir="ltr">

<a href="https://twitter.com/hashtag/metricstotheface?src=hash&amp;ref_src=twsrc%5Etfw">\#metricstotheface</a> <a href="https://t.co/iJogWqNLot">pic.twitter.com/iJogWqNLot</a>

</p>

--- Jeffrey Wooldridge (@jmwooldridge) <a href="https://twitter.com/jmwooldridge/status/1374558461095206917?ref_src=twsrc%5Etfw">March 24, 2021</a>

</blockquote>

```{=html}
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
```
</html>

## Variance and Standard Deviation

The second moment of *X* is $E[X^2]$ The second central moment of *X* is $E[(X – \mu)^2]$ - For the discrete uniform distribution of $Z$ from the previous exercise, calculate $Var(Z)$.

```{r discreteVz, exercise = TRUE}


```

```{r discreteVz-hint}

...%*%... # (E(x^2))
```

```{r discreteVz-solution}
# Define x 
z <- c(0:10)
# Define p(x) 
pz <- rep(1/length(z), length(z))
# Calculate E(z), E(z)^2, and E(z^2)
z%*%pz
(z%*%pz)^2
z^2%*%pz
```

```{r discreteVz-check}
grade_code()
```

Variance of a continuous R.V.

```{r continuousVx, exercise = TRUE}
# Define f(x), xf(x), and x^2f(x) 

# Calculate E(x), E(x)^2, and E(x^2)

```

```{r continuousVx-hint}
# The "function" function lets you define a mathematical function of a continuous real valued-x. 
f.x <- function(x) {...}
xf.x <- function(x) {...}
x2f.x <- function(x) {...}
# Use the "integrate" function to calculate the appropriate integrals (add up the itty bits).
integrate(xf.x, ..., ...)
integrate(xf.x, ... = , ...)^2
integrate(x2f.x, ..., ...)
```

```{r continuousVx-solution}
# Define f(x) 
f.x <- function(x) {1/10}
xf.x <- function(x) {x/10}
x2f.x <- function(x) {x^2/10}
# Calculate E(x), E(X)^2, and E(X^2)
integrate(xf.x, 0, 10)
integrate(xf.x, 0, 10)^2
integrate(x2f.x, 0, 10)
```

```{r continuousVx-check}
grade_code()
```

## Variance and Standard Deviation of a Linear Function of a Random Variable

Variance and constants Intercept terms "drop out" because constants have no variance. Slope terms are squared for the variance.

## Other Moments of a Random Variable

-   Skewness

    -   3rd moment: $E[X^3]$;
    -   3rd central moment: $E[(X – \mu)^3]$;
    -   3rd standardized moment: $E[(\frac{X – \mu}{\sigma})^3]$

-   Kurtosis

    -   4th moment: $E[X^4]$;
    -   4th central moment: $E[(X – \mu)^4]$;
    -   4th standardized moment: $E[(\frac{X – \mu}{\sigma})^4]$
