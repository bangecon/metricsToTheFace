---
title: "Chapter 3-3 Practice"
output: 
  learnr::tutorial: 
    progressive: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
library(wooldridge)
gpa1 <- wooldridge::gpa1
gradethis_setup()
tutorial_options(exercise.timelimit = 60)
knitr::opts_chunk$set(echo = FALSE)
```

## College GPA 

Simulate the bias term from the omitted variable bias formula, $E(\tilde\beta_1) = \beta_1 + \beta_2\delta$ for the model $CollegeGPA = \beta_0 + \beta_1HighSchoolGPA + \beta_2ACTScore + u$ using the $gpa1$ data. 

1. Extract the coefficient vector (`coef()`) from the OLS estimates of college GPA on ACT score and HS GPA. 
2. Extract the coefficient vector from the OLS estimates of high school GPA on ACT score. 
3. Calculate the formula for the biased simple regression model, $\tilde\beta_1 = \hat\beta_1 + \hat\beta_2\hat\delta$. 
4. Summarize the results of the OLS regression of college GPA on ACT score.

```{r omittedVariableBias, exercise=TRUE}

```

```{r omittedVariableBias-solution, exercise.reveal_solution = FALSE}
beta.hat <- lm(colGPA ~ ACT+hsGPA, data=gpa1) |> 
  coef()
delta.tilde <- lm(hsGPA ~ ACT, data=gpa1) |>
  coef()
beta.hat["ACT"] + beta.hat["hsGPA"]*delta.tilde["ACT"]
summary(beta.tilde <- lm(colGPA ~ ACT, data=gpa1))
```

```{r omittedVariableBias-check}
grade_this({if (!inherits(.result, c("summary.lm"))) {
    fail("Your class of your answer should be summary of an `lm` object.")}
  if (round(.result$coef[2],4) != 0.0271) { 
    fail("The coefficients on ACT score should be about 0.027") }
  pass("Note that the combination of the unbiased estimate (\hat\beta_{ACT}) and the bias (\hat\beta_{HSGPA}*\hat\delta)")
})
```
